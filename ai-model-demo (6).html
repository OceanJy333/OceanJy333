<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 模型开发流程 Demo</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background-color: #f8f9fa;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            background-color: #343a40;
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
            border-radius: 0 0 10px 10px;
        }
        .header h1 {
            margin: 0;
            font-size: 1.8rem;
        }
        .header p {
            margin: 5px 0 0;
            opacity: 0.8;
        }
        .nav-tabs {
            margin-bottom: 20px;
            border-bottom: 2px solid #dee2e6;
        }
        .nav-tabs .nav-link {
            border: none;
            color: #495057;
            position: relative;
            transition: all 0.3s;
            font-weight: 500;
            padding: 12px 20px;
        }
        .nav-tabs .nav-link.active {
            color: #007bff;
            background-color: transparent;
            border-bottom: 3px solid #007bff;
        }
        .nav-tabs .nav-link:hover:not(.active) {
            background-color: rgba(0,123,255,0.1);
            border-bottom: 3px solid #dee2e6;
        }
        .card {
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            border: none;
        }
        .card-header {
            background-color: #f8f9fa;
            border-bottom: 1px solid #eaeaea;
            padding: 15px 20px;
            font-weight: 600;
            border-radius: 10px 10px 0 0 !important;
        }
        .code-block {
            background-color: #272822;
            color: #f8f8f2;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            margin-bottom: 20px;
            overflow-x: auto;
        }
        .code-comment {
            color: #75715e;
        }
        .code-keyword {
            color: #f92672;
        }
        .code-string {
            color: #a6e22e;
        }
        .code-function {
            color: #66d9ef;
        }
        .badge-better {
            background-color: #28a745;
            color: white;
            font-size: 0.7rem;
            padding: 3px 6px;
            border-radius: 3px;
            margin-left: 5px;
        }
        .progress {
            height: 25px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        .progress-sm {
            height: 10px;
            margin-bottom: 5px;
        }
        .confidence-high {
            background-color: #28a745;
        }
        .confidence-low {
            background-color: #dc3545;
        }
        .action-btn {
            margin-right: 5px;
        }
        .status-badge {
            font-size: 0.8rem;
            padding: 5px 10px;
            border-radius: 20px;
        }
        .model-metrics {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        .metric-card {
            flex: 1;
            min-width: 120px;
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .metric-value {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 5px 0;
        }
        .metric-name {
            font-size: 0.9rem;
            color: #6c757d;
        }
        .training-log {
            max-height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border: 1px solid #eaeaea;
        }
        .chat-message {
            padding: 10px 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            background-color: #f1f1f1;
            position: relative;
        }
        .scam-message {
            background-color: #ffe6e6;
        }
        .tag-normal, .tag-scam {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            margin-left: 10px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        .tag-normal {
            background-color: #d4edda;
            color: #155724;
        }
        .tag-scam {
            background-color: #f8d7da;
            color: #721c24;
        }
        .data-table-container {
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        .hidden {
            display: none;
        }
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        .step {
            flex: 1;
            text-align: center;
            position: relative;
            padding-bottom: 10px;
        }
        .step::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: #dee2e6;
            z-index: 1;
        }
        .step.active::after {
            background-color: #007bff;
        }
        .step.completed::after {
            background-color: #28a745;
        }
        .step span {
            position: relative;
            z-index: 2;
            display: inline-block;
            width: 30px;
            height: 30px;
            line-height: 30px;
            border-radius: 50%;
            background-color: #dee2e6;
            color: #6c757d;
            font-weight: bold;
        }
        .step.active span {
            background-color: #007bff;
            color: white;
        }
        .step.completed span {
            background-color: #28a745;
            color: white;
        }
        .step p {
            margin-top: 5px;
            font-size: 0.9rem;
            color: #6c757d;
        }
        .step.active p, .step.completed p {
            color: #212529;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1>AI 模型开发流程 Demo</h1>
                    <p>游戏聊天欺诈检测模型开发示例</p>
                </div>
                <div class="step-indicator d-none d-md-flex" style="width: 50%;">
                    <div class="step active" id="step-1">
                        <span>1</span>
                        <p>数据准备</p>
                    </div>
                    <div class="step" id="step-2">
                        <span>2</span>
                        <p>模型训练</p>
                    </div>
                    <div class="step" id="step-3">
                        <span>3</span>
                        <p>模型验证</p>
                    </div>
                    <div class="step" id="step-4">
                        <span>4</span>
                        <p>模型部署</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container main-content">
        <ul class="nav nav-tabs" id="modelTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="data-tab" data-bs-toggle="tab" data-bs-target="#data" type="button" role="tab" aria-controls="data" aria-selected="true">
                    <i class="fas fa-database me-2"></i>数据准备
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="training-tab" data-bs-toggle="tab" data-bs-target="#training" type="button" role="tab" aria-controls="training" aria-selected="false">
                    <i class="fas fa-cogs me-2"></i>模型训练
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="validation-tab" data-bs-toggle="tab" data-bs-target="#validation" type="button" role="tab" aria-controls="validation" aria-selected="false">
                    <i class="fas fa-check-circle me-2"></i>模型验证
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="deployment-tab" data-bs-toggle="tab" data-bs-target="#deployment" type="button" role="tab" aria-controls="deployment" aria-selected="false">
                    <i class="fas fa-rocket me-2"></i>模型部署
                </button>
            </li>
        </ul>

        <div class="tab-content" id="modelTabsContent">
            <!-- 数据准备标签页 -->
            <div class="tab-pane fade show active" id="data" role="tabpanel" aria-labelledby="data-tab">
                <div class="row">
                    <div class="col-lg-7">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span>标注数据列表</span>
                                <div>
                                    <span class="badge bg-primary me-2">总计: <span id="total-data-count">0</span></span>
                                    <span class="badge bg-success me-2">正常: <span id="normal-data-count">0</span></span>
                                    <span class="badge bg-danger">拉人诈骗: <span id="scam-data-count">0</span></span>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="data-table-container">
                                    <table class="table table-hover" id="data-table">
                                        <thead>
                                            <tr>
                                                <th width="5%">#</th>
                                                <th width="65%">聊天内容</th>
                                                <th width="15%">标签</th>
                                                <th width="15%">操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- 数据将通过 JavaScript 动态添加 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-5">
                        <div class="card">
                            <div class="card-header">添加新数据</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="chat-content" class="form-label">聊天内容</label>
                                    <textarea class="form-control" id="chat-content" rows="4" placeholder="输入聊天内容..."></textarea>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label d-block">标签</label>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="label" id="label-normal" value="normal" checked>
                                        <label class="form-check-label" for="label-normal">正常</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="label" id="label-scam" value="scam">
                                        <label class="form-check-label" for="label-scam">拉人诈骗</label>
                                    </div>
                                </div>
                                <button id="add-data-btn" class="btn btn-primary">添加数据</button>
                            </div>
                        </div>
                        <div class="card mt-3">
                            <div class="card-header">标注指南</div>
                            <div class="card-body">
                                <h6>正常消息特征：</h6>
                                <ul>
                                    <li>游戏相关的正常交流</li>
                                    <li>不包含外部联系方式</li>
                                    <li>不包含明显诱导性语言</li>
                                </ul>
                                <h6>拉人诈骗特征：</h6>
                                <ul>
                                    <li>包含外部联系方式（QQ、微信等）</li>
                                    <li>提及账号买卖、代练</li>
                                    <li>提及快速赚钱、刷金币等</li>
                                    <li>使用诱导性语言</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="d-flex justify-content-end mt-3">
                    <button id="go-to-training-btn" class="btn btn-primary">
                        <i class="fas fa-arrow-right me-1"></i> 下一步：模型训练
                    </button>
                </div>
            </div>

            <!-- 模型训练标签页 -->
            <div class="tab-pane fade" id="training" role="tabpanel" aria-labelledby="training-tab">
                <div class="row">
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">模型训练配置</div>
                            <div class="card-body">
                                <div class="code-block">
<span class="code-comment"># 模型训练配置（简化展示）</span>
<span class="code-keyword">import</span> tensorflow <span class="code-keyword">as</span> tf

<span class="code-comment"># 模型 A - 学习率过高，容易梯度爆炸</span>
model_a_config = {
    'learning_rate': 0.1,  <span class="code-comment"># 学习率过高</span>
    'batch_size': 16,
    'epochs': 30
}

<span class="code-comment"># 模型 B - 合理参数配置</span>
model_b_config = {
    'learning_rate': 0.001,  <span class="code-comment"># 适当的学习率</span>
    'batch_size': 32,
    'epochs': 30,
    'early_stopping': True
}
                                </div>
                                <div class="mt-3">
                                    <div class="btn-group w-100" role="group">
                                        <button id="train-model-a-btn" class="btn btn-outline-danger">
                                            <i class="fas fa-play me-1"></i> 训练模型 A
                                        </button>
                                        <button id="train-model-b-btn" class="btn btn-outline-success">
                                            <i class="fas fa-play me-1"></i> 训练模型 B
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                <ul class="nav nav-tabs card-header-tabs" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="model-a-tab" data-bs-toggle="tab" data-bs-target="#model-a-training" type="button" role="tab">模型 A</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="model-b-tab" data-bs-toggle="tab" data-bs-target="#model-b-training" type="button" role="tab">模型 B</button>
                                    </li>
                                </ul>
                            </div>
                            <div class="card-body">
                                <div class="tab-content">
                                    <div class="tab-pane fade show active" id="model-a-training" role="tabpanel">
                                        <div class="alert alert-primary mb-3" id="model-a-status">
                                            点击"训练模型 A"按钮开始训练过程。
                                        </div>
                                        <div class="mb-3">
                                            <p class="mb-1">训练进度：<span id="model-a-epoch">0</span>/<span id="total-epochs-a">30</span> 轮次</p>
                                            <div class="progress">
                                                <div id="model-a-progress" class="progress-bar progress-bar-striped progress-bar-animated bg-danger" role="progressbar" style="width: 0%"></div>
                                            </div>
                                        </div>
                                        <div class="training-log" id="model-a-log"></div>
                                        <div class="mt-3">
                                            <canvas id="model-a-chart" height="200"></canvas>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="model-b-training" role="tabpanel">
                                        <div class="alert alert-primary mb-3" id="model-b-status">
                                            点击"训练模型 B"按钮开始训练过程。
                                        </div>
                                        <div class="mb-3">
                                            <p class="mb-1">训练进度：<span id="model-b-epoch">0</span>/<span id="total-epochs-b">30</span> 轮次</p>
                                            <div class="progress">
                                                <div id="model-b-progress" class="progress-bar progress-bar-striped progress-bar-animated bg-success" role="progressbar" style="width: 0%"></div>
                                            </div>
                                        </div>
                                        <div class="training-log" id="model-b-log"></div>
                                        <div class="mt-3">
                                            <canvas id="model-b-chart" height="200"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="d-flex justify-content-between mt-3">
                    <button id="back-to-data-btn" class="btn btn-secondary">
                        <i class="fas fa-arrow-left me-1"></i> 返回：数据准备
                    </button>
                    <button id="go-to-validation-btn" class="btn btn-primary" disabled>
                        <i class="fas fa-arrow-right me-1"></i> 下一步：模型验证
                    </button>
                </div>
            </div>

            <!-- 模型验证标签页 -->
            <div class="tab-pane fade" id="validation" role="tabpanel" aria-labelledby="validation-tab">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <span>模型性能验证</span>
                        <button id="start-validation-btn" class="btn btn-sm btn-primary">
                            <i class="fas fa-check me-1"></i> 开始验证
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-primary mb-4" id="validation-status">
                            点击"开始验证"按钮评估模型性能。
                        </div>
                        <div class="mb-4 hidden" id="validation-progress-container">
                            <p class="mb-1">验证进度</p>
                            <div class="progress">
                                <div id="validation-progress" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="row hidden" id="models-comparison">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">模型 A (梯度爆炸模型)</div>
                                    <div class="card-body">
                                        <div class="alert alert-danger mb-3" style="font-size: 0.85rem;">
                                            <i class="fas fa-exclamation-triangle me-2"></i> 模型训练过程中发生梯度爆炸，性能不稳定
                                        </div>
                                        <div class="model-metrics">
                                            <div class="metric-card">
                                                <div class="metric-name">准确率</div>
                                                <div class="metric-value" id="model-a-accuracy">61.4%</div>
                                            </div>
                                            <div class="metric-card">
                                                <div class="metric-name">精确率</div>
                                                <div class="metric-value" id="model-a-precision">58.2%</div>
                                            </div>
                                            <div class="metric-card">
                                                <div class="metric-name">召回率</div>
                                                <div class="metric-value" id="model-a-recall">63.7%</div>
                                            </div>
                                            <div class="metric-card">
                                                <div class="metric-name">F1 分数</div>
                                                <div class="metric-value" id="model-a-f1">60.8%</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">模型 B (正常收敛模型)</div>
                                    <div class="card-body">
                                        <div class="alert alert-success mb-3" style="font-size: 0.85rem;">
                                            <i class="fas fa-check-circle me-2"></i> 模型训练稳定，成功收敛
                                        </div>
                                        <div class="model-metrics">
                                            <div class="metric-card">
                                                <div class="metric-name">准确率</div>
                                                <div class="metric-value" id="model-b-accuracy">92.5%</div>
                                                <span class="badge-better">+31.1%</span>
                                            </div>
                                            <div class="metric-card">
                                                <div class="metric-name">精确率</div>
                                                <div class="metric-value" id="model-b-precision">91.8%</div>
                                                <span class="badge-better">+33.6%</span>
                                            </div>
                                            <div class="metric-card">
                                                <div class="metric-name">召回率</div>
                                                <div class="metric-value" id="model-b-recall">90.3%</div>
                                                <span class="badge-better">+26.6%</span>
                                            </div>
                                            <div class="metric-card">
                                                <div class="metric-name">F1 分数</div>
                                                <div class="metric-value" id="model-b-f1">91.0%</div>
                                                <span class="badge-better">+30.2%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mt-4 hidden" id="validation-result">
                            <div class="alert alert-success">
                                <i class="fas fa-check-circle me-2"></i> 根据验证结果，模型 B 在所有指标上都明显优于模型 A（提升约30%），建议部署模型 B。模型 A 由于训练过程中梯度爆炸问题，性能表现不佳。
                            </div>
                        </div>
                    </div>
                </div>
                <div class="d-flex justify-content-between mt-3">
                    <button id="back-to-training-btn" class="btn btn-secondary">
                        <i class="fas fa-arrow-left me-1"></i> 返回：模型训练
                    </button>
                    <button id="go-to-deployment-btn" class="btn btn-primary" disabled>
                        <i class="fas fa-arrow-right me-1"></i> 下一步：模型部署
                    </button>
                </div>
            </div>

            <!-- 模型部署标签页 -->
            <div class="tab-pane fade" id="deployment" role="tabpanel" aria-labelledby="deployment-tab">
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">置信度分级处理</div>
                            <div class="card-body">
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <div class="card">
                                            <div class="card-header text-white bg-success">高置信度 (≥90%)</div>
                                            <div class="card-body">
                                                <p>自动处理，无需人工干预</p>
                                                <ul>
                                                    <li>预测为拉人诈骗：自动封禁</li>
                                                    <li>预测为正常：自动放行</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card">
                                            <div class="card-header text-white bg-danger">低置信度 (<90%)</div>
                                            <div class="card-body">
                                                <p>需要人工判断审核</p>
                                                <ul>
                                                    <li>进入审核队列</li>
                                                    <li>审核员确认最终处理（放行/封禁）</li>
                                                    <li>人工标注的样本将加入下次模型训练集</li>
                                                    <li>形成持续优化的闭环</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">实时预测结果</div>
                            <div class="card-body">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th width="5%">#</th>
                                            <th width="40%">聊天内容</th>
                                            <th width="15%">预测结果</th>
                                            <th width="20%">置信度</th>
                                            <th width="20%">处理状态</th>
                                        </tr>
                                    </thead>
                                    <tbody id="prediction-table">
                                        <tr>
                                            <td>1</td>
                                            <td>大佬求带，我是新手刚入坑，不会玩</td>
                                            <td><span class="badge bg-success">正常</span></td>
                                            <td>
                                                <div class="progress progress-sm">
                                                    <div class="progress-bar confidence-high" role="progressbar" style="width: 97%"></div>
                                                </div>
                                                <small>97%</small>
                                            </td>
                                            <td><span class="badge bg-success status-badge">自动放行</span></td>
                                        </tr>
                                        <tr>
                                            <td>2</td>
                                            <td>加我微信xxxx，带你赚钱，每天稳赚300+</td>
                                            <td><span class="badge bg-danger">拉人诈骗</span></td>
                                            <td>
                                                <div class="progress progress-sm">
                                                    <div class="progress-bar confidence-high" role="progressbar" style="width: 95%"></div>
                                                </div>
                                                <small>95%</small>
                                            </td>
                                            <td><span class="badge bg-danger status-badge">自动封禁</span></td>
                                        </tr>
                                        <tr>
                                            <td>3</td>
                                            <td>有没有大佬一起玩，加我好友一起开黑，QQ群：123456</td>
                                            <td><span class="badge bg-danger">拉人诈骗</span></td>
                                            <td>
                                                <div class="progress progress-sm">
                                                    <div class="progress-bar confidence-low" role="progressbar" style="width: 75%"></div>
                                                </div>
                                                <small>75%</small>
                                            </td>
                                            <td>
                                                <span class="badge bg-secondary status-badge">待审核</span>
                                                <div class="mt-1">
                                                    <button class="btn btn-sm btn-success action-btn approve-btn">放行</button>
                                                    <button class="btn btn-sm btn-danger action-btn ban-btn">封禁</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>4</td>
                                            <td>朋友们谁知道哪里可以找到攻略，这个副本太难了</td>
                                            <td><span class="badge bg-success">正常</span></td>
                                            <td>
                                                <div class="progress progress-sm">
                                                    <div class="progress-bar confidence-low" role="progressbar" style="width: 82%"></div>
                                                </div>
                                                <small>82%</small>
                                            </td>
                                            <td>
                                                <span class="badge bg-secondary status-badge">待审核</span>
                                                <div class="mt-1">
                                                    <button class="btn btn-sm btn-success action-btn approve-btn">放行</button>
                                                    <button class="btn btn-sm btn-danger action-btn ban-btn">封禁</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>5</td>
                                            <td>有朋友一起打团吗？我是法师，找个坦克</td>
                                            <td><span class="badge bg-success">正常</span></td>
                                            <td>
                                                <div class="progress progress-sm">
                                                    <div class="progress-bar confidence-high" role="progressbar" style="width: 93%"></div>
                                                </div>
                                                <small>93%</small>
                                            </td>
                                            <td><span class="badge bg-success status-badge">自动放行</span></td>
                                        </tr>
                                        <tr id="review-sample">
                                            <td>6</td>
                                            <td>我有个工作室，批发各种游戏账号，价格便宜，有意者联系</td>
                                            <td><span class="badge bg-danger">拉人诈骗</span></td>
                                            <td>
                                                <div class="progress progress-sm">
                                                    <div class="progress-bar confidence-low" role="progressbar" style="width: 55%"></div>
                                                </div>
                                                <small>55%</small>
                                            </td>
                                            <td id="review-status">
                                                <span class="badge bg-secondary status-badge">待审核</span>
                                                <div class="mt-1">
                                                    <button class="btn btn-sm btn-success action-btn approve-btn">放行</button>
                                                    <button class="btn btn-sm btn-danger action-btn ban-btn">封禁</button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="d-flex justify-content-between mt-3">
                    <button id="back-to-validation-btn" class="btn btn-secondary">
                        <i class="fas fa-arrow-left me-1"></i> 返回：模型验证
                    </button>
                    <button id="complete-demo-btn" class="btn btn-success">
                        <i class="fas fa-check-circle me-1"></i> 完成 Demo
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // 声明全局变量
            let trainingData = [];
            let nextId = 1;
            let modelAChart = null;
            let modelBChart = null;
            
            // 定义数据集
            const initialData = [
                { id: 1, content: "大家好，我是新手，求带", label: "normal" },
                { id: 2, content: "加我微信12345，教你快速赚钱，日入500+", label: "scam" },
                { id: 3, content: "我们公会正在招人，有兴趣的可以加入", label: "normal" },
                { id: 4, content: "有人带我打副本吗？谢谢大佬们", label: "normal" },
                { id: 5, content: "组队打BOSS，私聊我", label: "normal" },
                { id: 6, content: "出售各种游戏账号，价格便宜，联系QQ：123456", label: "scam" },
                { id: 7, content: "我这有最新外挂，加微信获取，包你上分", label: "scam" },
                { id: 8, content: "这个副本太难了，谁有攻略", label: "normal" },
                { id: 9, content: "有没有人一起玩啊，好无聊", label: "normal" },
                { id: 10, content: "代练接单，价格公道，联系方式看我资料", label: "scam" }
            ];
            
            // 初始化数据
            trainingData = [...initialData];
            nextId = initialData.length + 1;
            
            // 更新数据计数
            function updateDataCounts() {
                const totalCount = trainingData.length;
                const normalCount = trainingData.filter(item => item.label === "normal").length;
                const scamCount = trainingData.filter(item => item.label === "scam").length;
                
                document.getElementById("total-data-count").textContent = totalCount;
                document.getElementById("normal-data-count").textContent = normalCount;
                document.getElementById("scam-data-count").textContent = scamCount;
            }
            
            // 渲染数据表
            function renderDataTable() {
                const tableBody = document.querySelector("#data-table tbody");
                tableBody.innerHTML = "";
                
                trainingData.forEach(item => {
                    const row = document.createElement("tr");
                    
                    const idCell = document.createElement("td");
                    idCell.textContent = item.id;
                    
                    const contentCell = document.createElement("td");
                    contentCell.textContent = item.content;
                    
                    const labelCell = document.createElement("td");
                    const labelBadge = document.createElement("span");
                    if (item.label === "normal") {
                        labelBadge.className = "tag-normal";
                        labelBadge.textContent = "正常";
                    } else {
                        labelBadge.className = "tag-scam";
                        labelBadge.textContent = "拉人诈骗";
                    }
                    labelCell.appendChild(labelBadge);
                    
                    const actionCell = document.createElement("td");
                    const deleteBtn = document.createElement("button");
                    deleteBtn.className = "btn btn-sm btn-outline-danger";
                    deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
                    deleteBtn.addEventListener("click", () => {
                        trainingData = trainingData.filter(d => d.id !== item.id);
                        renderDataTable();
                        updateDataCounts();
                    });
                    actionCell.appendChild(deleteBtn);
                    
                    row.appendChild(idCell);
                    row.appendChild(contentCell);
                    row.appendChild(labelCell);
                    row.appendChild(actionCell);
                    
                    tableBody.appendChild(row);
                });
            }
            
            // 添加数据
            const addDataBtn = document.getElementById("add-data-btn");
            if (addDataBtn) {
                addDataBtn.addEventListener("click", function() {
                    const content = document.getElementById("chat-content").value.trim();
                    if (!content) {
                        alert("请输入聊天内容");
                        return;
                    }
                    
                    const label = document.querySelector('input[name="label"]:checked').value;
                    
                    trainingData.push({
                        id: nextId++,
                        content,
                        label
                    });
                    
                    document.getElementById("chat-content").value = "";
                    
                    renderDataTable();
                    updateDataCounts();
                });
            }
            
            // 添加训练日志
            function addLogEntry(logElement, message) {
                const logEntry = document.createElement("div");
                logEntry.textContent = message;
                logElement.appendChild(logEntry);
                logElement.scrollTop = logElement.scrollHeight;
            }
            
            // 创建模型A图表
            function createModelAChart() {
                if (modelAChart) return modelAChart;
                
                const ctx = document.getElementById('model-a-chart').getContext('2d');
                modelAChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [
                            {
                                label: '损失值',
                                data: [],
                                borderColor: '#dc3545',
                                backgroundColor: 'rgba(220, 53, 69, 0.1)',
                                tension: 0.3,
                                yAxisID: 'y'
                            },
                            {
                                label: '准确率',
                                data: [],
                                borderColor: '#198754',
                                backgroundColor: 'rgba(25, 135, 84, 0.1)',
                                tension: 0.3,
                                yAxisID: 'y1'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        interaction: {
                            mode: 'index',
                            intersect: false,
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                title: {
                                    display: true,
                                    text: '损失值'
                                },
                                min: 0,
                                suggestedMax: 10
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                grid: {
                                    drawOnChartArea: false,
                                },
                                title: {
                                    display: true,
                                    text: '准确率'
                                },
                                min: 0,
                                max: 1,
                                ticks: {
                                    callback: function(value) {
                                        return (value * 100).toFixed(0) + '%';
                                    }
                                }
                            },
                        }
                    }
                });
                return modelAChart;
            }
            
            // 创建模型B图表
            function createModelBChart() {
                if (modelBChart) return modelBChart;
                
                const ctx = document.getElementById('model-b-chart').getContext('2d');
                modelBChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [
                            {
                                label: '损失值',
                                data: [],
                                borderColor: '#dc3545',
                                backgroundColor: 'rgba(220, 53, 69, 0.1)',
                                tension: 0.3,
                                yAxisID: 'y'
                            },
                            {
                                label: '准确率',
                                data: [],
                                borderColor: '#198754',
                                backgroundColor: 'rgba(25, 135, 84, 0.1)',
                                tension: 0.3,
                                yAxisID: 'y1'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        interaction: {
                            mode: 'index',
                            intersect: false,
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                title: {
                                    display: true,
                                    text: '损失值'
                                },
                                min: 0,
                                suggestedMax: 1
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                grid: {
                                    drawOnChartArea: false,
                                },
                                title: {
                                    display: true,
                                    text: '准确率'
                                },
                                min: 0,
                                max: 1,
                                ticks: {
                                    callback: function(value) {
                                        return (value * 100).toFixed(0) + '%';
                                    }
                                }
                            },
                        }
                    }
                });
                return modelBChart;
            }
            
            // 训练模型A按钮
            const trainModelABtn = document.getElementById("train-model-a-btn");
            let modelATrainingStarted = false;
            
            if (trainModelABtn) {
                trainModelABtn.addEventListener("click", function() {
                    if (modelATrainingStarted) return;
                    
                    modelATrainingStarted = true;
                    const chart = createModelAChart();
                    let currentEpoch = 0;
                    const totalEpochs = 30;
                    
                    // 更新状态
                    document.getElementById("model-a-status").className = "alert alert-info mb-3";
                    document.getElementById("model-a-status").innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> 模型 A 训练中（学习率过高）...';
                    
                    // 清空日志
                    document.getElementById("model-a-log").innerHTML = "";
                    
                    const trainingInterval = setInterval(() => {
                        currentEpoch++;
                        
                        // 更新进度条
                        const progress = (currentEpoch / totalEpochs) * 100;
                        document.getElementById("model-a-progress").style.width = progress + "%";
                        document.getElementById("model-a-epoch").textContent = currentEpoch;
                        
                        // 模拟梯度爆炸和无法收敛的情况
                        let loss, accuracy;
                        
                        if (currentEpoch <= 3) {
                            // 初始阶段，看起来正常
                            loss = 0.7 - (currentEpoch * 0.1) + (Math.random() * 0.05);
                            accuracy = 0.5 + (currentEpoch * 0.06) + (Math.random() * 0.03);
                        } else if (currentEpoch <= 8) {
                            // 开始不稳定
                            loss = 0.5 + (currentEpoch - 3) * 0.2 + (Math.random() * 0.3);
                            accuracy = 0.7 - (Math.random() * 0.1);
                        } else {
                            // 完全崩溃，梯度爆炸
                            loss = 5 + (currentEpoch - 8) * 0.5 + (Math.random() * 1);
                            accuracy = 0.5 + (Math.random() * 0.05);
                        }
                        
                        // 添加到图表
                        chart.data.labels.push(`轮次 ${currentEpoch}`);
                        chart.data.datasets[0].data.push(loss);
                        chart.data.datasets[1].data.push(accuracy);
                        chart.update();
                        
                        // 添加训练日志
                        addLogEntry(
                            document.getElementById("model-a-log"), 
                            `轮次 ${currentEpoch}/${totalEpochs}: 损失值 = ${loss.toFixed(4)}, 准确率 = ${(accuracy * 100).toFixed(2)}%`
                        );
                        
                        // 模拟训练失败
                        if (currentEpoch === 12) {
                            clearInterval(trainingInterval);
                            
                            // 更新训练状态
                            document.getElementById("model-a-status").className = "alert alert-danger mb-3";
                            document.getElementById("model-a-status").innerHTML = '<i class="fas fa-exclamation-triangle me-2"></i> 模型 A 训练失败！出现梯度爆炸问题。';
                            
                            // 添加失败日志
                            addLogEntry(document.getElementById("model-a-log"), "警告：损失值急剧增加，可能出现梯度爆炸。");
                            addLogEntry(document.getElementById("model-a-log"), "错误：NaN 值出现在训练过程中。");
                            addLogEntry(document.getElementById("model-a-log"), "训练中断：模型无法收敛。");
                            
                            // 完成训练后自动切换到模型 B
                            setTimeout(() => {
                                const modelBTab = document.getElementById("model-b-tab");
                                if (modelBTab) {
                                    modelBTab.click();
                                }
                            }, 1000);
                        }
                    }, 500);
                });
            }
            
            // 训练模型B按钮
            const trainModelBBtn = document.getElementById("train-model-b-btn");
            let modelBTrainingStarted = false;
            
            if (trainModelBBtn) {
                trainModelBBtn.addEventListener("click", function() {
                    if (modelBTrainingStarted) return;
                    
                    modelBTrainingStarted = true;
                    const chart = createModelBChart();
                    let currentEpoch = 0;
                    const totalEpochs = 30;
                    
                    // 更新状态
                    document.getElementById("model-b-status").className = "alert alert-info mb-3";
                    document.getElementById("model-b-status").innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> 模型 B 训练中...';
                    
                    // 清空日志
                    document.getElementById("model-b-log").innerHTML = "";
                    
                    const trainingInterval = setInterval(() => {
                        currentEpoch++;
                        
                        // 提前结束训练检查
                        if (currentEpoch > totalEpochs) {
                            clearInterval(trainingInterval);
                            return;
                        }
                        
                        // 更新进度条
                        const progress = (currentEpoch / totalEpochs) * 100;
                        document.getElementById("model-b-progress").style.width = progress + "%";
                        document.getElementById("model-b-epoch").textContent = currentEpoch;
                        
                        // 模拟正常收敛的损失值和准确率
                        let loss, accuracy;
                        
                        if (currentEpoch <= 5) {
                            // 初始阶段，快速下降/上升
                            loss = 0.7 - (currentEpoch * 0.08) + (Math.random() * 0.03);
                            accuracy = 0.5 + (currentEpoch * 0.06) + (Math.random() * 0.02);
                        } else if (currentEpoch <= 15) {
                            // 中间阶段，较慢改善
                            loss = 0.3 - ((currentEpoch - 5) * 0.012) + (Math.random() * 0.02);
                            accuracy = 0.8 + ((currentEpoch - 5) * 0.008) + (Math.random() * 0.015);
                        } else {
                            // 后期阶段，趋于平稳
                            loss = 0.15 - ((currentEpoch - 15) * 0.002) + (Math.random() * 0.005);
                            accuracy = 0.9 + ((currentEpoch - 15) * 0.002) + (Math.random() * 0.004);
                            
                            // 确保合理范围
                            loss = Math.max(0.05, loss);
                            accuracy = Math.min(0.97, accuracy);
                        }
                        
                        // 添加到图表
                        chart.data.labels.push(`轮次 ${currentEpoch}`);
                        chart.data.datasets[0].data.push(loss);
                        chart.data.datasets[1].data.push(accuracy);
                        chart.update();
                        
                        // 添加训练日志
                        addLogEntry(
                            document.getElementById("model-b-log"), 
                            `轮次 ${currentEpoch}/${totalEpochs}: 损失值 = ${loss.toFixed(4)}, 准确率 = ${(accuracy * 100).toFixed(2)}%`
                        );
                        
                        // 训练完成
                        if (currentEpoch === totalEpochs) {
                            clearInterval(trainingInterval);
                            
                            // 更新训练状态
                            document.getElementById("model-b-status").className = "alert alert-success mb-3";
                            document.getElementById("model-b-status").innerHTML = '<i class="fas fa-check-circle me-2"></i> 模型 B 训练完成！';
                            
                            // 添加最终训练日志
                            addLogEntry(document.getElementById("model-b-log"), "训练完成，模型已保存。");
                            addLogEntry(document.getElementById("model-b-log"), "最终训练集准确率：92.8%");
                            addLogEntry(document.getElementById("model-b-log"), "最终验证集准确率：91.5%");
                            
                            // 启用下一步按钮
                            const goToValidationBtn = document.getElementById("go-to-validation-btn");
                            if (goToValidationBtn) {
                                goToValidationBtn.disabled = false;
                            }
                            
                            // 更新进度指示器
                            const step2 = document.getElementById("step-2");
                            const step3 = document.getElementById("step-3");
                            if (step2) step2.classList.add("completed");
                            if (step3) step3.classList.add("active");
                        }
                    }, 400);
                });
            }
            
            // 验证按钮
            const startValidationBtn = document.getElementById("start-validation-btn");
            let validationStarted = false;
            
            if (startValidationBtn) {
                startValidationBtn.addEventListener("click", function() {
                    if (validationStarted) return;
                    
                    validationStarted = true;
                    
                    // 显示验证进度条
                    document.getElementById("validation-status").className = "alert alert-info mb-4";
                    document.getElementById("validation-status").innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> 正在验证模型性能...';
                    document.getElementById("validation-progress-container").classList.remove("hidden");
                    
                    // 模拟验证进度
                    let progress = 0;
                    const progressBar = document.getElementById("validation-progress");
                    
                    const validationInterval = setInterval(() => {
                        progress += 5;
                        progressBar.style.width = progress + "%";
                        
                        if (progress >= 100) {
                            clearInterval(validationInterval);
                            
                            // 显示验证结果
                            document.getElementById("validation-status").className = "alert alert-success mb-4";
                            document.getElementById("validation-status").innerHTML = '<i class="fas fa-check-circle me-2"></i> 模型验证完成！';
                            document.getElementById("models-comparison").classList.remove("hidden");
                            document.getElementById("validation-result").classList.remove("hidden");
                            
                            // 启用下一步按钮
                            const goToDeploymentBtn = document.getElementById("go-to-deployment-btn");
                            if (goToDeploymentBtn) {
                                goToDeploymentBtn.disabled = false;
                            }
                            
                            // 更新进度指示器
                            const step3 = document.getElementById("step-3");
                            const step4 = document.getElementById("step-4");
                            if (step3) step3.classList.add("completed");
                            if (step4) step4.classList.add("active");
                        }
                    }, 100);
                });
            }
            
            // 审核按钮
            document.querySelectorAll(".approve-btn, .ban-btn").forEach(btn => {
                btn.addEventListener("click", function() {
                    const isApprove = this.classList.contains("approve-btn");
                    // 获取当前按钮所在的行的状态指示器
                    const parentTd = this.closest('td');
                    
                    if (parentTd) {
                        // 移除按钮
                        const btnDiv = parentTd.querySelector("div");
                        if (btnDiv) {
                            btnDiv.remove();
                        }
                        
                        // 更新状态
                        const statusBadge = parentTd.querySelector(".status-badge");
                        if (statusBadge) {
                            if (isApprove) {
                                statusBadge.className = "badge bg-success status-badge";
                                statusBadge.textContent = "已放行";
                            } else {
                                statusBadge.className = "badge bg-danger status-badge";
                                statusBadge.textContent = "已封禁";
                            }
                        }
                        
                        // 记录到模型优化数据中
                        const row = parentTd.closest('tr');
                        if (row) {
                            const content = row.querySelector('td:nth-child(2)').textContent;
                            console.log(`已将"${content}"标记为"${isApprove ? '正常' : '拉人诈骗'}"，此样本将加入下次训练集优化模型`);
                        }
                    }
                });
            });
            
            // 导航按钮
            // 1. 数据页 -> 训练页
            const goToTrainingBtn = document.getElementById("go-to-training-btn");
            if (goToTrainingBtn) {
                goToTrainingBtn.addEventListener("click", function() {
                    const trainingTab = document.getElementById("training-tab");
                    if (trainingTab) {
                        const tab = new bootstrap.Tab(trainingTab);
                        tab.show();
                    }
                    
                    const step1 = document.getElementById("step-1");
                    const step2 = document.getElementById("step-2");
                    if (step1) step1.classList.add("completed");
                    if (step2) step2.classList.add("active");
                });
            }
            
            // 2. 训练页 -> 数据页
            const backToDataBtn = document.getElementById("back-to-data-btn");
            if (backToDataBtn) {
                backToDataBtn.addEventListener("click", function() {
                    const dataTab = document.getElementById("data-tab");
                    if (dataTab) {
                        const tab = new bootstrap.Tab(dataTab);
                        tab.show();
                    }
                });
            }
            
            // 3. 训练页 -> 验证页
            const goToValidationBtn = document.getElementById("go-to-validation-btn");
            if (goToValidationBtn) {
                goToValidationBtn.addEventListener("click", function() {
                    const validationTab = document.getElementById("validation-tab");
                    if (validationTab) {
                        const tab = new bootstrap.Tab(validationTab);
                        tab.show();
                    }
                });
            }
            
            // 4. 验证页 -> 训练页
            const backToTrainingBtn = document.getElementById("back-to-training-btn");
            if (backToTrainingBtn) {
                backToTrainingBtn.addEventListener("click", function() {
                    const trainingTab = document.getElementById("training-tab");
                    if (trainingTab) {
                        const tab = new bootstrap.Tab(trainingTab);
                        tab.show();
                    }
                });
            }
            
            // 5. 验证页 -> 部署页
            const goToDeploymentBtn = document.getElementById("go-to-deployment-btn");
            if (goToDeploymentBtn) {
                goToDeploymentBtn.addEventListener("click", function() {
                    const deploymentTab = document.getElementById("deployment-tab");
                    if (deploymentTab) {
                        const tab = new bootstrap.Tab(deploymentTab);
                        tab.show();
                    }
                });
            }
            
            // 6. 部署页 -> 验证页
            const backToValidationBtn = document.getElementById("back-to-validation-btn");
            if (backToValidationBtn) {
                backToValidationBtn.addEventListener("click", function() {
                    const validationTab = document.getElementById("validation-tab");
                    if (validationTab) {
                        const tab = new bootstrap.Tab(validationTab);
                        tab.show();
                    }
                });
            }
            
            // 完成按钮
            const completeDemoBtn = document.getElementById("complete-demo-btn");
            if (completeDemoBtn) {
                completeDemoBtn.addEventListener("click", function() {
                    alert("恭喜您完成了 AI 模型开发流程 Demo！");
                });
            }
            
            // 标签页切换事件
            document.querySelectorAll('button[data-bs-toggle="tab"]').forEach(button => {
                button.addEventListener('shown.bs.tab', function (event) {
                    const targetId = event.target.id;
                    const steps = document.querySelectorAll('.step');
                    
                    steps.forEach(step => step.classList.remove('active'));
                    
                    if (targetId === 'data-tab') {
                        document.getElementById('step-1').classList.add('active');
                    } else if (targetId === 'training-tab') {
                        document.getElementById('step-2').classList.add('active');
                    } else if (targetId === 'validation-tab') {
                        document.getElementById('step-3').classList.add('active');
                    } else if (targetId === 'deployment-tab') {
                        document.getElementById('step-4').classList.add('active');
                    }
                });
            });
            
            // 初始化数据表格
            renderDataTable();
            updateDataCounts();
        });
    </script>
</body>
</html>